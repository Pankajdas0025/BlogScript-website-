#############################################
# âœ… BLOGSCRIPT - INFINITYFREE .HTACCESS
# Clean URLs + Basic Security Hardening
#############################################

# =========================
# âœ… BASIC HARDENING
# =========================
Options -Indexes
ServerSignature Off

# =========================
# âœ… REWRITE ENGINE ON
# =========================
<IfModule mod_rewrite.c>
RewriteEngine On

# -------------------------
# ðŸ”’ Block hidden files/folders (.env, .git, etc.)
# -------------------------
RewriteRule (^|/)\. - [F,L]

# -------------------------
# ðŸ”’ Block common malicious query strings (SQLi/XSS/LFI)
# -------------------------
RewriteCond %{QUERY_STRING} (\.\./|%2e%2e%2f|<|>|%3c|%3e|union.*select|concat\(|base64_encode|GLOBALS|_REQUEST) [NC,OR]
RewriteCond %{QUERY_STRING} (php://|filter=|input=|expect://) [NC]
RewriteRule .* - [F,L]

# -------------------------
# âœ… If file or folder exists, don't rewrite
# -------------------------
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# =========================
# âœ… CLEAN URLs (YOUR ROUTES)
# =========================
RewriteRule ^$ index.php [L]
RewriteRule ^home$ index.php [L]
RewriteRule ^register$ authentication.php [L]
RewriteRule ^admin$ admin.php [L]
RewriteRule ^create$ create.php [L]
RewriteRule ^delete$ delete.php [L]
RewriteRule ^view$ view.php [L]
RewriteRule ^update$ update.php [L]
RewriteRule ^reset-password$ reset.php [L]
RewriteRule ^login$ login.php [L]
RewriteRule ^signup$ signup.php [L]
RewriteRule ^verification$ verification.php [L]
RewriteRule ^update-user-password$ updatepass.php [L]
RewriteRule ^logout$ logout.php [L]
RewriteRule ^profile$ profile.php [L]

</IfModule>

# =========================
# ðŸ”’ BLOCK SENSITIVE FILE TYPES
# =========================
<FilesMatch "\.(env|ini|log|sql|bak|old|zip|tar|gz|rar)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block common project files (composer/node)
<FilesMatch "^(composer\.(json|lock)|package(-lock)?\.json|yarn\.lock)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# =========================
# âœ… OPTIONAL: Force HTTPS
# (Enable only if your site ALWAYS runs on https)
# =========================
# RewriteCond %{HTTPS} off
# RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

#############################################
# âœ… END
#############################################
