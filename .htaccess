#############################################
# âœ… BLOGSCRIPT - INFINITYFREE .HTACCESS
# Clean URLs + Basic Security (API Safe)
#############################################

Options -Indexes
ServerSignature Off

<IfModule mod_rewrite.c>
RewriteEngine On

# =========================
# âœ… 1) ALLOW API ROUTES FIRST
# (prevents security rules from blocking API)
# =========================
RewriteRule ^api/ - [L]

# =========================
# âœ… 2) BLOCK HIDDEN FILES/FOLDERS (.env, .git, etc.)
# =========================
RewriteRule (^|/)\. - [F,L]

# =========================
# âœ… 3) BLOCK SOME MALICIOUS QUERY STRINGS
# (removed < and > because it causes false blocks)
# =========================
RewriteCond %{QUERY_STRING} (\.\./|%2e%2e%2f|union.*select|concat\(|base64_encode|GLOBALS|_REQUEST) [NC,OR]
RewriteCond %{QUERY_STRING} (php://|filter=|input=|expect://) [NC]
RewriteRule .* - [F,L]

# =========================
# âœ… 4) IF FILE OR FOLDER EXISTS, DON'T REWRITE
# =========================
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# =========================
# âœ… 5) CLEAN URL ROUTES
# =========================
RewriteRule ^$ index.php [L]
RewriteRule ^home$ index.php [L]
RewriteRule ^register$ authentication.php [L]
RewriteRule ^admin$ admin.php [L]
RewriteRule ^create$ create.php [L]
RewriteRule ^delete$ delete.php [L]
RewriteRule ^view$ view.php [L]
RewriteRule ^update$ update.php [L]
RewriteRule ^reset-password$ reset.php [L]
RewriteRule ^login$ login.php [L]
RewriteRule ^signup$ signup.php [L]
RewriteRule ^verification$ verification.php [L]
RewriteRule ^update-user-password$ updatepass.php [L]
RewriteRule ^logout$ logout.php [L]
RewriteRule ^profile$ profile.php [L]

</IfModule>

# =========================
# ðŸ”’ BLOCK SENSITIVE FILE TYPES
# =========================
<FilesMatch "\.(env|ini|log|sql|bak|old|zip|tar|gz|rar)$">
  Require all denied
</FilesMatch>

<FilesMatch "^(composer\.(json|lock)|package(-lock)?\.json|yarn\.lock)$">
  Require all denied
</FilesMatch>

#############################################
# âœ… END
#############################################
